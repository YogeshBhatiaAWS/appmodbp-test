"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.EbsCsiDriverAddOn = void 0;
const core_addon_1 = require("../core-addon");
const iam_policy_1 = require("./iam-policy");
/**
 * Default values for the add-on
 */
const defaultProps = {
    addOnName: "aws-ebs-csi-driver",
    version: "v1.21.0-eksbuild.1",
    saName: "ebs-csi-controller-sa",
};
/**
 * Implementation of EBS CSI Driver EKS add-on
 */
class EbsCsiDriverAddOn extends core_addon_1.CoreAddOn {
    constructor(options) {
        var _a;
        super({
            addOnName: defaultProps.addOnName,
            version: (_a = options === null || options === void 0 ? void 0 : options.version) !== null && _a !== void 0 ? _a : defaultProps.version,
            saName: defaultProps.saName
        });
        this.options = options;
    }
    providePolicyDocument(clusterInfo) {
        var _a;
        return (0, iam_policy_1.getEbsDriverPolicyDocument)(clusterInfo.cluster.stack.partition, (_a = this.options) === null || _a === void 0 ? void 0 : _a.kmsKeys);
    }
}
exports.EbsCsiDriverAddOn = EbsCsiDriverAddOn;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9saWIvYWRkb25zL2Vicy1jc2ktZHJpdmVyL2luZGV4LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUdBLDhDQUEwQztBQUMxQyw2Q0FBMEQ7QUFnQjFEOztHQUVHO0FBQ0gsTUFBTSxZQUFZLEdBQUc7SUFDakIsU0FBUyxFQUFFLG9CQUFvQjtJQUMvQixPQUFPLEVBQUUsb0JBQW9CO0lBQzdCLE1BQU0sRUFBRSx1QkFBdUI7Q0FDbEMsQ0FBQztBQUVGOztHQUVHO0FBQ0gsTUFBYSxpQkFBa0IsU0FBUSxzQkFBUztJQUU1QyxZQUFxQixPQUFnQzs7UUFDakQsS0FBSyxDQUFDO1lBQ0YsU0FBUyxFQUFFLFlBQVksQ0FBQyxTQUFTO1lBQ2pDLE9BQU8sRUFBRSxNQUFBLE9BQU8sYUFBUCxPQUFPLHVCQUFQLE9BQU8sQ0FBRSxPQUFPLG1DQUFJLFlBQVksQ0FBQyxPQUFPO1lBQ2pELE1BQU0sRUFBRSxZQUFZLENBQUMsTUFBTTtTQUM5QixDQUFDLENBQUM7UUFMYyxZQUFPLEdBQVAsT0FBTyxDQUF5QjtJQU1yRCxDQUFDO0lBRUQscUJBQXFCLENBQUMsV0FBd0I7O1FBQzFDLE9BQU8sSUFBQSx1Q0FBMEIsRUFBQyxXQUFXLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxTQUFTLEVBQUUsTUFBQSxJQUFJLENBQUMsT0FBTywwQ0FBRSxPQUFPLENBQUMsQ0FBQztJQUNsRyxDQUFDO0NBQ0o7QUFiRCw4Q0FhQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBvbGljeURvY3VtZW50IH0gZnJvbSBcImF3cy1jZGstbGliL2F3cy1pYW1cIjtcclxuaW1wb3J0ICogYXMga21zIGZyb20gXCJhd3MtY2RrLWxpYi9hd3Mta21zXCI7XHJcbmltcG9ydCB7IENsdXN0ZXJJbmZvIH0gZnJvbSBcIi4uLy4uL3NwaVwiO1xyXG5pbXBvcnQgeyBDb3JlQWRkT24gfSBmcm9tIFwiLi4vY29yZS1hZGRvblwiO1xyXG5pbXBvcnQgeyBnZXRFYnNEcml2ZXJQb2xpY3lEb2N1bWVudCB9IGZyb20gXCIuL2lhbS1wb2xpY3lcIjtcclxuXHJcbi8qKlxyXG4gKiBJbnRlcmZhY2UgZm9yIEVCUyBDU0kgRHJpdmVyIEVLUyBhZGQtb24gb3B0aW9uc1xyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBFYnNDc2lEcml2ZXJBZGRPblByb3BzIHtcclxuICAgIC8qKlxyXG4gICAgICogVmVyc2lvbiBvZiB0aGUgZHJpdmVyIHRvIGRlcGxveVxyXG4gICAgICovXHJcbiAgICB2ZXJzaW9uPzogc3RyaW5nO1xyXG4gICAgLyoqXHJcbiAgICAgKiBMaXN0IG9mIEtNUyBrZXlzIHRvIGJlIHVzZWQgZm9yIGVuY3J5cHRpb25cclxuICAgICAqL1xyXG4gICAga21zS2V5cz86IGttcy5LZXlbXTtcclxufVxyXG5cclxuLyoqXHJcbiAqIERlZmF1bHQgdmFsdWVzIGZvciB0aGUgYWRkLW9uXHJcbiAqL1xyXG5jb25zdCBkZWZhdWx0UHJvcHMgPSB7XHJcbiAgICBhZGRPbk5hbWU6IFwiYXdzLWVicy1jc2ktZHJpdmVyXCIsXHJcbiAgICB2ZXJzaW9uOiBcInYxLjIxLjAtZWtzYnVpbGQuMVwiLFxyXG4gICAgc2FOYW1lOiBcImVicy1jc2ktY29udHJvbGxlci1zYVwiLFxyXG59O1xyXG5cclxuLyoqXHJcbiAqIEltcGxlbWVudGF0aW9uIG9mIEVCUyBDU0kgRHJpdmVyIEVLUyBhZGQtb25cclxuICovXHJcbmV4cG9ydCBjbGFzcyBFYnNDc2lEcml2ZXJBZGRPbiBleHRlbmRzIENvcmVBZGRPbiB7XHJcblxyXG4gICAgY29uc3RydWN0b3IocmVhZG9ubHkgb3B0aW9ucz86IEVic0NzaURyaXZlckFkZE9uUHJvcHMpIHtcclxuICAgICAgICBzdXBlcih7XHJcbiAgICAgICAgICAgIGFkZE9uTmFtZTogZGVmYXVsdFByb3BzLmFkZE9uTmFtZSxcclxuICAgICAgICAgICAgdmVyc2lvbjogb3B0aW9ucz8udmVyc2lvbiA/PyBkZWZhdWx0UHJvcHMudmVyc2lvbixcclxuICAgICAgICAgICAgc2FOYW1lOiBkZWZhdWx0UHJvcHMuc2FOYW1lXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJvdmlkZVBvbGljeURvY3VtZW50KGNsdXN0ZXJJbmZvOiBDbHVzdGVySW5mbykgOiBQb2xpY3lEb2N1bWVudCB7XHJcbiAgICAgICAgcmV0dXJuIGdldEVic0RyaXZlclBvbGljeURvY3VtZW50KGNsdXN0ZXJJbmZvLmNsdXN0ZXIuc3RhY2sucGFydGl0aW9uLCB0aGlzLm9wdGlvbnM/Lmttc0tleXMpO1xyXG4gICAgfVxyXG59XHJcblxyXG4iXX0=