"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.AwsLoadBalancerControllerAddOn = void 0;
const iam = require("aws-cdk-lib/aws-iam");
require("reflect-metadata");
const registry_utils_1 = require("../../utils/registry-utils");
const helm_addon_1 = require("../helm-addon");
const iam_policy_1 = require("./iam-policy");
const AWS_LOAD_BALANCER_CONTROLLER = 'aws-load-balancer-controller';
/**
 * Defaults options for the add-on
 */
const defaultProps = {
    name: AWS_LOAD_BALANCER_CONTROLLER,
    namespace: 'kube-system',
    chart: AWS_LOAD_BALANCER_CONTROLLER,
    repository: 'https://aws.github.io/eks-charts',
    release: AWS_LOAD_BALANCER_CONTROLLER,
    version: '1.6.0',
    enableShield: false,
    enableWaf: false,
    enableWafv2: false,
    createIngressClassResource: true,
    ingressClass: "alb",
    enableServiceMutatorWebhook: false
};
function lookupImage(registry, region) {
    if (registry == null) {
        console.log("Unable to get ECR repository for AWS Loadbalancer Controller for region " + region) + ". Using default helm image";
        return {};
    }
    return { image: { repository: registry + "amazon/aws-load-balancer-controller" } };
}
let AwsLoadBalancerControllerAddOn = exports.AwsLoadBalancerControllerAddOn = class AwsLoadBalancerControllerAddOn extends helm_addon_1.HelmAddOn {
    constructor(props) {
        super({ ...defaultProps, ...props });
        this.options = this.props;
    }
    deploy(clusterInfo) {
        const cluster = clusterInfo.cluster;
        const serviceAccount = cluster.addServiceAccount('aws-load-balancer-controller', {
            name: AWS_LOAD_BALANCER_CONTROLLER,
            namespace: this.options.namespace,
        });
        (0, iam_policy_1.AwsLoadbalancerControllerIamPolicy)(cluster.stack.partition).Statement.forEach((statement) => {
            serviceAccount.addToPrincipalPolicy(iam.PolicyStatement.fromJson(statement));
        });
        const registry = registry_utils_1.registries.get(cluster.stack.region);
        const image = lookupImage(registry, cluster.stack.region);
        const awsLoadBalancerControllerChart = this.addHelmChart(clusterInfo, {
            clusterName: cluster.clusterName,
            serviceAccount: {
                create: false,
                name: serviceAccount.serviceAccountName,
            },
            // must disable waf features for aws-cn partition
            enableShield: this.options.enableShield,
            enableWaf: this.options.enableWaf,
            enableWafv2: this.options.enableWafv2,
            createIngressClassResource: this.options.createIngressClassResource,
            ingressClass: this.options.ingressClass,
            enableServiceMutatorWebhook: this.options.enableServiceMutatorWebhook,
            region: clusterInfo.cluster.stack.region,
            ...image,
            vpcId: clusterInfo.cluster.vpc.vpcId,
        }, undefined, false);
        awsLoadBalancerControllerChart.node.addDependency(serviceAccount);
        // return the Promise Construct for any teams that may depend on this
        return Promise.resolve(awsLoadBalancerControllerChart);
    }
};
exports.AwsLoadBalancerControllerAddOn = AwsLoadBalancerControllerAddOn = __decorate([
    Reflect.metadata("ordered", true)
], AwsLoadBalancerControllerAddOn);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9saWIvYWRkb25zL2F3cy1sb2FkYmFsYW5jZXItY29udHJvbGxlci9pbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQSwyQ0FBMkM7QUFFM0MsNEJBQTBCO0FBRTFCLCtEQUF3RDtBQUN4RCw4Q0FBOEQ7QUFDOUQsNkNBQWtFO0FBeUNsRSxNQUFNLDRCQUE0QixHQUFHLDhCQUE4QixDQUFDO0FBRXBFOztHQUVHO0FBQ0gsTUFBTSxZQUFZLEdBQW1DO0lBQ2pELElBQUksRUFBRSw0QkFBNEI7SUFDbEMsU0FBUyxFQUFFLGFBQWE7SUFDeEIsS0FBSyxFQUFFLDRCQUE0QjtJQUNuQyxVQUFVLEVBQUUsa0NBQWtDO0lBQzlDLE9BQU8sRUFBRSw0QkFBNEI7SUFDckMsT0FBTyxFQUFFLE9BQU87SUFDaEIsWUFBWSxFQUFFLEtBQUs7SUFDbkIsU0FBUyxFQUFFLEtBQUs7SUFDaEIsV0FBVyxFQUFFLEtBQUs7SUFDbEIsMEJBQTBCLEVBQUUsSUFBSTtJQUNoQyxZQUFZLEVBQUUsS0FBSztJQUNuQiwyQkFBMkIsRUFBRSxLQUFLO0NBQ3JDLENBQUM7QUFHRixTQUFTLFdBQVcsQ0FBQyxRQUFpQixFQUFFLE1BQWU7SUFDbkQsSUFBSSxRQUFRLElBQUksSUFBSSxFQUFFO1FBQ2xCLE9BQU8sQ0FBQyxHQUFHLENBQUMsMEVBQTBFLEdBQUcsTUFBTSxDQUFDLEdBQUcsNEJBQTRCLENBQUM7UUFDaEksT0FBTyxFQUFFLENBQUM7S0FDYjtJQUVELE9BQU8sRUFBRSxLQUFLLEVBQUUsRUFBRSxVQUFVLEVBQUUsUUFBUSxHQUFHLHFDQUFxQyxFQUFFLEVBQUUsQ0FBQztBQUN2RixDQUFDO0FBR00sSUFBTSw4QkFBOEIsNENBQXBDLE1BQU0sOEJBQStCLFNBQVEsc0JBQVM7SUFJekQsWUFBWSxLQUFzQztRQUM5QyxLQUFLLENBQUMsRUFBRSxHQUFHLFlBQW1CLEVBQUUsR0FBRyxLQUFLLEVBQUUsQ0FBQyxDQUFDO1FBQzVDLElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDLEtBQXVDLENBQUM7SUFDaEUsQ0FBQztJQUVELE1BQU0sQ0FBQyxXQUF3QjtRQUMzQixNQUFNLE9BQU8sR0FBRyxXQUFXLENBQUMsT0FBTyxDQUFDO1FBQ3BDLE1BQU0sY0FBYyxHQUFHLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQyw4QkFBOEIsRUFBRTtZQUM3RSxJQUFJLEVBQUUsNEJBQTRCO1lBQ2xDLFNBQVMsRUFBRSxJQUFJLENBQUMsT0FBTyxDQUFDLFNBQVM7U0FDcEMsQ0FBQyxDQUFDO1FBRUgsSUFBQSwrQ0FBa0MsRUFBQyxPQUFPLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxTQUFTLEVBQUUsRUFBRTtZQUN4RixjQUFjLENBQUMsb0JBQW9CLENBQUMsR0FBRyxDQUFDLGVBQWUsQ0FBQyxRQUFRLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQztRQUNqRixDQUFDLENBQUMsQ0FBQztRQUVILE1BQU0sUUFBUSxHQUFHLDJCQUFVLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUM7UUFFdEQsTUFBTSxLQUFLLEdBQUcsV0FBVyxDQUFDLFFBQVEsRUFBRSxPQUFPLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBRTFELE1BQU0sOEJBQThCLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQyxXQUFXLEVBQUU7WUFDbEUsV0FBVyxFQUFFLE9BQU8sQ0FBQyxXQUFXO1lBQ2hDLGNBQWMsRUFBRTtnQkFDWixNQUFNLEVBQUUsS0FBSztnQkFDYixJQUFJLEVBQUUsY0FBYyxDQUFDLGtCQUFrQjthQUMxQztZQUNELGlEQUFpRDtZQUNqRCxZQUFZLEVBQUUsSUFBSSxDQUFDLE9BQU8sQ0FBQyxZQUFZO1lBQ3ZDLFNBQVMsRUFBRSxJQUFJLENBQUMsT0FBTyxDQUFDLFNBQVM7WUFDakMsV0FBVyxFQUFFLElBQUksQ0FBQyxPQUFPLENBQUMsV0FBVztZQUNyQywwQkFBMEIsRUFBRSxJQUFJLENBQUMsT0FBTyxDQUFDLDBCQUEwQjtZQUNuRSxZQUFZLEVBQUUsSUFBSSxDQUFDLE9BQU8sQ0FBQyxZQUFZO1lBQ3ZDLDJCQUEyQixFQUFFLElBQUksQ0FBQyxPQUFPLENBQUMsMkJBQTJCO1lBQ3JFLE1BQU0sRUFBRSxXQUFXLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxNQUFNO1lBQ3hDLEdBQUcsS0FBSztZQUNSLEtBQUssRUFBRSxXQUFXLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxLQUFLO1NBQ3ZDLEVBQUUsU0FBUyxFQUFFLEtBQUssQ0FBQyxDQUFDO1FBRXJCLDhCQUE4QixDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsY0FBYyxDQUFDLENBQUM7UUFDbEUscUVBQXFFO1FBQ3JFLE9BQU8sT0FBTyxDQUFDLE9BQU8sQ0FBQyw4QkFBOEIsQ0FBQyxDQUFDO0lBQzNELENBQUM7Q0FDSixDQUFBO3lDQTlDWSw4QkFBOEI7SUFEMUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxTQUFTLEVBQUUsSUFBSSxDQUFDO0dBQ3JCLDhCQUE4QixDQThDMUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBpYW0gZnJvbSBcImF3cy1jZGstbGliL2F3cy1pYW1cIjtcbmltcG9ydCB7IENvbnN0cnVjdCB9IGZyb20gXCJjb25zdHJ1Y3RzXCI7XG5pbXBvcnQgXCJyZWZsZWN0LW1ldGFkYXRhXCI7XG5pbXBvcnQgeyBDbHVzdGVySW5mbywgVmFsdWVzIH0gZnJvbSBcIi4uLy4uL3NwaVwiO1xuaW1wb3J0IHsgcmVnaXN0cmllcyB9IGZyb20gXCIuLi8uLi91dGlscy9yZWdpc3RyeS11dGlsc1wiO1xuaW1wb3J0IHsgSGVsbUFkZE9uLCBIZWxtQWRkT25Vc2VyUHJvcHMgfSBmcm9tIFwiLi4vaGVsbS1hZGRvblwiO1xuaW1wb3J0IHsgQXdzTG9hZGJhbGFuY2VyQ29udHJvbGxlcklhbVBvbGljeSB9IGZyb20gXCIuL2lhbS1wb2xpY3lcIjtcblxuLyoqXG4gKiBDb25maWd1cmF0aW9uIG9wdGlvbnMgZm9yIHRoZSBhZGQtb24uXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgQXdzTG9hZEJhbGFuY2VyQ29udHJvbGxlclByb3BzIGV4dGVuZHMgSGVsbUFkZE9uVXNlclByb3BzIHtcblxuICAgIC8qKlxuICAgICAqIEVuYWJsZSBTaGllbGQgKG11c3QgYmUgZmFsc2UgZm9yIENOIHBhcnRpdGlvbilcbiAgICAgKi9cbiAgICBlbmFibGVTaGllbGQ/OiBib29sZWFuLFxuXG4gICAgLyoqXG4gICAgICogRW5hYmxlIFdBRiAobXVzdCBiZSBmYWxzZSBmb3IgQ04gcGFydGl0aW9uKVxuICAgICAqL1xuICAgIGVuYWJsZVdhZj86IGJvb2xlYW4sXG5cbiAgICAvKipcbiAgICAgKiBFbmFibGUgV0FGVjIgKG11c3QgYmUgZmFsc2UgZm9yIENOIHBhcnRpdGlvbilcbiAgICAgKi9cbiAgICBlbmFibGVXYWZ2Mj86IGJvb2xlYW4sXG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgdGhlIGluZ3Jlc3NDbGFzcyB0byBiZSB1c2VkIGJ5IHRoZSBBTEIgY29udHJvbGxlclxuICAgICAqL1xuICAgIGNyZWF0ZUluZ3Jlc3NDbGFzc1Jlc291cmNlPzogYm9vbGVhblxuXG4gICAgLyoqXG4gICAgICogTmFtZSBvZiBpbmdyZXNzQ2xhc3MgdG8gdGhlIEFMQiBjb250cm9sbGVyIHdpbGwgc2F0aXNmeS4gSWYgbm90IHByb3ZpZGVkXG4gICAgICogdGhlIHZhbHVlIHdpbGwgYmUgZGVmYXVsdGVkIHRvIFwiYWxiXCJcbiAgICAgKi9cbiAgICBpbmdyZXNzQ2xhc3M/OiBzdHJpbmcsXG5cbiAgICAvKipcbiAgICAgKiBJZiBmYWxzZSwgZGlzYWJsZSB0aGUgU2VydmljZSBNdXRhdG9yIHdlYmhvb2sgd2hpY2ggbWFrZXMgYWxsIG5ldyBzZXJ2aWNlcyBvZiB0eXBlIExvYWRCYWxhbmNlciByZWNvbmNpbGVkIGJ5IHRoZSBsYiBjb250cm9sbGVyLlxuICAgICAqIEBkZWZhdWx0IGZhbHNlICAgXG4gICAgICovXG4gICAgZW5hYmxlU2VydmljZU11dGF0b3JXZWJob29rPzogYm9vbGVhblxufVxuXG5cbmNvbnN0IEFXU19MT0FEX0JBTEFOQ0VSX0NPTlRST0xMRVIgPSAnYXdzLWxvYWQtYmFsYW5jZXItY29udHJvbGxlcic7XG5cbi8qKlxuICogRGVmYXVsdHMgb3B0aW9ucyBmb3IgdGhlIGFkZC1vblxuICovXG5jb25zdCBkZWZhdWx0UHJvcHM6IEF3c0xvYWRCYWxhbmNlckNvbnRyb2xsZXJQcm9wcyA9IHtcbiAgICBuYW1lOiBBV1NfTE9BRF9CQUxBTkNFUl9DT05UUk9MTEVSLFxuICAgIG5hbWVzcGFjZTogJ2t1YmUtc3lzdGVtJyxcbiAgICBjaGFydDogQVdTX0xPQURfQkFMQU5DRVJfQ09OVFJPTExFUixcbiAgICByZXBvc2l0b3J5OiAnaHR0cHM6Ly9hd3MuZ2l0aHViLmlvL2Vrcy1jaGFydHMnLFxuICAgIHJlbGVhc2U6IEFXU19MT0FEX0JBTEFOQ0VSX0NPTlRST0xMRVIsXG4gICAgdmVyc2lvbjogJzEuNi4wJyxcbiAgICBlbmFibGVTaGllbGQ6IGZhbHNlLFxuICAgIGVuYWJsZVdhZjogZmFsc2UsXG4gICAgZW5hYmxlV2FmdjI6IGZhbHNlLFxuICAgIGNyZWF0ZUluZ3Jlc3NDbGFzc1Jlc291cmNlOiB0cnVlLFxuICAgIGluZ3Jlc3NDbGFzczogXCJhbGJcIixcbiAgICBlbmFibGVTZXJ2aWNlTXV0YXRvcldlYmhvb2s6IGZhbHNlXG59O1xuXG5cbmZ1bmN0aW9uIGxvb2t1cEltYWdlKHJlZ2lzdHJ5Pzogc3RyaW5nLCByZWdpb24/OiBzdHJpbmcpOiBWYWx1ZXMge1xuICAgIGlmIChyZWdpc3RyeSA9PSBudWxsKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiVW5hYmxlIHRvIGdldCBFQ1IgcmVwb3NpdG9yeSBmb3IgQVdTIExvYWRiYWxhbmNlciBDb250cm9sbGVyIGZvciByZWdpb24gXCIgKyByZWdpb24pICsgXCIuIFVzaW5nIGRlZmF1bHQgaGVsbSBpbWFnZVwiO1xuICAgICAgICByZXR1cm4ge307XG4gICAgfVxuXG4gICAgcmV0dXJuIHsgaW1hZ2U6IHsgcmVwb3NpdG9yeTogcmVnaXN0cnkgKyBcImFtYXpvbi9hd3MtbG9hZC1iYWxhbmNlci1jb250cm9sbGVyXCIgfSB9O1xufVxuXG5AUmVmbGVjdC5tZXRhZGF0YShcIm9yZGVyZWRcIiwgdHJ1ZSlcbmV4cG9ydCBjbGFzcyBBd3NMb2FkQmFsYW5jZXJDb250cm9sbGVyQWRkT24gZXh0ZW5kcyBIZWxtQWRkT24ge1xuXG4gICAgcmVhZG9ubHkgb3B0aW9uczogQXdzTG9hZEJhbGFuY2VyQ29udHJvbGxlclByb3BzO1xuXG4gICAgY29uc3RydWN0b3IocHJvcHM/OiBBd3NMb2FkQmFsYW5jZXJDb250cm9sbGVyUHJvcHMpIHtcbiAgICAgICAgc3VwZXIoeyAuLi5kZWZhdWx0UHJvcHMgYXMgYW55LCAuLi5wcm9wcyB9KTtcbiAgICAgICAgdGhpcy5vcHRpb25zID0gdGhpcy5wcm9wcyBhcyBBd3NMb2FkQmFsYW5jZXJDb250cm9sbGVyUHJvcHM7XG4gICAgfVxuXG4gICAgZGVwbG95KGNsdXN0ZXJJbmZvOiBDbHVzdGVySW5mbyk6IFByb21pc2U8Q29uc3RydWN0PiB7XG4gICAgICAgIGNvbnN0IGNsdXN0ZXIgPSBjbHVzdGVySW5mby5jbHVzdGVyO1xuICAgICAgICBjb25zdCBzZXJ2aWNlQWNjb3VudCA9IGNsdXN0ZXIuYWRkU2VydmljZUFjY291bnQoJ2F3cy1sb2FkLWJhbGFuY2VyLWNvbnRyb2xsZXInLCB7XG4gICAgICAgICAgICBuYW1lOiBBV1NfTE9BRF9CQUxBTkNFUl9DT05UUk9MTEVSLFxuICAgICAgICAgICAgbmFtZXNwYWNlOiB0aGlzLm9wdGlvbnMubmFtZXNwYWNlLFxuICAgICAgICB9KTtcblxuICAgICAgICBBd3NMb2FkYmFsYW5jZXJDb250cm9sbGVySWFtUG9saWN5KGNsdXN0ZXIuc3RhY2sucGFydGl0aW9uKS5TdGF0ZW1lbnQuZm9yRWFjaCgoc3RhdGVtZW50KSA9PiB7XG4gICAgICAgICAgICBzZXJ2aWNlQWNjb3VudC5hZGRUb1ByaW5jaXBhbFBvbGljeShpYW0uUG9saWN5U3RhdGVtZW50LmZyb21Kc29uKHN0YXRlbWVudCkpO1xuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCByZWdpc3RyeSA9IHJlZ2lzdHJpZXMuZ2V0KGNsdXN0ZXIuc3RhY2sucmVnaW9uKTtcblxuICAgICAgICBjb25zdCBpbWFnZSA9IGxvb2t1cEltYWdlKHJlZ2lzdHJ5LCBjbHVzdGVyLnN0YWNrLnJlZ2lvbik7XG5cbiAgICAgICAgY29uc3QgYXdzTG9hZEJhbGFuY2VyQ29udHJvbGxlckNoYXJ0ID0gdGhpcy5hZGRIZWxtQ2hhcnQoY2x1c3RlckluZm8sIHtcbiAgICAgICAgICAgIGNsdXN0ZXJOYW1lOiBjbHVzdGVyLmNsdXN0ZXJOYW1lLFxuICAgICAgICAgICAgc2VydmljZUFjY291bnQ6IHtcbiAgICAgICAgICAgICAgICBjcmVhdGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgIG5hbWU6IHNlcnZpY2VBY2NvdW50LnNlcnZpY2VBY2NvdW50TmFtZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvLyBtdXN0IGRpc2FibGUgd2FmIGZlYXR1cmVzIGZvciBhd3MtY24gcGFydGl0aW9uXG4gICAgICAgICAgICBlbmFibGVTaGllbGQ6IHRoaXMub3B0aW9ucy5lbmFibGVTaGllbGQsXG4gICAgICAgICAgICBlbmFibGVXYWY6IHRoaXMub3B0aW9ucy5lbmFibGVXYWYsXG4gICAgICAgICAgICBlbmFibGVXYWZ2MjogdGhpcy5vcHRpb25zLmVuYWJsZVdhZnYyLFxuICAgICAgICAgICAgY3JlYXRlSW5ncmVzc0NsYXNzUmVzb3VyY2U6IHRoaXMub3B0aW9ucy5jcmVhdGVJbmdyZXNzQ2xhc3NSZXNvdXJjZSxcbiAgICAgICAgICAgIGluZ3Jlc3NDbGFzczogdGhpcy5vcHRpb25zLmluZ3Jlc3NDbGFzcyxcbiAgICAgICAgICAgIGVuYWJsZVNlcnZpY2VNdXRhdG9yV2ViaG9vazogdGhpcy5vcHRpb25zLmVuYWJsZVNlcnZpY2VNdXRhdG9yV2ViaG9vayxcbiAgICAgICAgICAgIHJlZ2lvbjogY2x1c3RlckluZm8uY2x1c3Rlci5zdGFjay5yZWdpb24sXG4gICAgICAgICAgICAuLi5pbWFnZSxcbiAgICAgICAgICAgIHZwY0lkOiBjbHVzdGVySW5mby5jbHVzdGVyLnZwYy52cGNJZCxcbiAgICAgICAgfSwgdW5kZWZpbmVkLCBmYWxzZSk7XG5cbiAgICAgICAgYXdzTG9hZEJhbGFuY2VyQ29udHJvbGxlckNoYXJ0Lm5vZGUuYWRkRGVwZW5kZW5jeShzZXJ2aWNlQWNjb3VudCk7XG4gICAgICAgIC8vIHJldHVybiB0aGUgUHJvbWlzZSBDb25zdHJ1Y3QgZm9yIGFueSB0ZWFtcyB0aGF0IG1heSBkZXBlbmQgb24gdGhpc1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGF3c0xvYWRCYWxhbmNlckNvbnRyb2xsZXJDaGFydCk7XG4gICAgfVxufSJdfQ==